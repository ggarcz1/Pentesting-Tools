import psutil
import platform

def get_elevated_services_windows():
    elevated_services = []
    for proc in psutil.process_iter(['pid', 'name', 'username']):
        try:
            if proc.info['username'] == 'SYSTEM':
                elevated_services.append(proc.info)
        except psutil.NoSuchProcess:
            continue
    return elevated_services


def get_elevated_services_linux():
    elevated_services = []
    for proc in psutil.process_iter(['pid', 'name', 'username']):
        try:
            if proc.info['username'] == 'root':
                elevated_services.append(proc.info)
        except psutil.NoSuchProcess:
            continue
    return elevated_services

if __name__ == '__main__':
    header = ''
    operating_system = platform.system()
    if operating_system == 'Windows':
        elevated_services = get_elevated_services_windows()
        header = 'Services running with elevated privileges (SYSTEM):'
    else:
        elevated_services = get_elevated_services_linux()
        header = 'Services running with elevated privileges (root):'

    if elevated_services:
        print(f'{header}')
        for service in elevated_services:
            print(service)
            # print(f'PID: {service['pid']}, Name: {service['name']}, User: {service['username']}')
    else:
        print('No services running with elevated privileges found.')
