# python ip_spoof.py <src_ip> <dst_ip>
# python ip_spoof.py 12.21.3.21 192.168.1.254

import sys
from scapy.all import send
from scapy.layers.inet import IP, ICMP, TCP
import random

# make sure input has the spoofed source and real destination IP
if len(sys.argv) == 1:
    source = input('Enter source IP, \'random\' for a random IP: ')
    if  source == 'random':
        source = ''
        for val in range(0,4):
            source += str(random.randint(0, 255))+'.'
    destination = input('Enter destination IP: ')
    packet = IP(src=source, dst=destination) / TCP()

elif len(sys.argv) == 3:
    packet = IP(src=sys.argv[1], dst=sys.argv[2]) / TCP()
    send(packet)

else:
    print('Incorrect command. Command format is\npython ip_spoof.py <src_ip> <dst_ip>')
    
# # add a string to the back to send the echo
# packet = IP(src=source[:-1], dst=sys.argv[2]) / ICMP()/input('Enter message to send: ')
# answer = send(packet)
# packet.show()
# # if the destination responds
# if answer:
#     answer.show()