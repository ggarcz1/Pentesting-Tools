.bat file

run command to get all past wifi connections
"netsh wlan show profiles interface="wi-fi""

run command to get passwords of these connections

"netsh wlan show profile name={SSID} key=clear"

"netsh wlan export profile key=clear folder={path}"
each wireless network has its own XML file

parse out:
<keyMaterial>PASSWORD</keyMaterial>